<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TravelBuddy â€” Smart Itinerary Planner</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b1220; --panel:#0f1724; --accent:#06b6d4; --accent-2:#2dd4bf;
  --text:#e6eef6; --muted:#94a3b8; --card:#071022;
}
body.light {
  --bg:#f5f7fb; --panel:#ffffff; --accent:#0ea5e9; --accent-2:#22c1c3;
  --text:#0b1220; --muted:#64748b; --card:#f8fafc;
}
*{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;}
html,body{height:100%;margin:0;background:var(--bg);color:var(--text);}
.app{max-width:1200px;margin:24px auto;display:grid;grid-template-columns:420px 1fr;gap:20px;padding:18px}
.panel{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.05);padding:14px;border-radius:12px}
@media (max-width:980px){.app{grid-template-columns:1fr;padding:12px}}
.chat{display:flex;flex-direction:column;height:78vh}
.top{display:flex;align-items:center;gap:12px;margin-bottom:8px}
.logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#042026;font-weight:700}
.title{font-size:16px;font-weight:600}
.subtitle{color:var(--muted);font-size:13px}
.messages{flex:1;overflow:auto;padding:10px;display:flex;flex-direction:column;gap:10px}
.bubble{max-width:84%;padding:10px 12px;border-radius:12px;line-height:1.35}
.bubble.bot{align-self:flex-start;background:rgba(255,255,255,0.05);color:var(--muted);}
.bubble.user{align-self:flex-end;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#042026}
.meta{font-size:11px;color:var(--muted);margin-top:6px}
.inputRow{display:flex;gap:8px;margin-top:10px}
.inputRow input{flex:1;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.08);background:transparent;color:inherit}
.btn{padding:10px 12px;border-radius:8px;border:0;background:var(--accent);color:#042026;cursor:pointer;font-weight:600}
.btn:focus-visible, .save-btn:focus-visible, .quick button:focus-visible, .inputRow input:focus-visible{outline:2px solid var(--accent-2);outline-offset:2px}
.quick{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
.quick button{background:transparent;border:1px dashed rgba(255,255,255,0.05);padding:6px 10px;border-radius:8px;color:var(--muted);cursor:pointer}
.faq{display:flex;flex-direction:column;gap:8px;margin-top:12px}
.faq-title{font-size:13px;color:var(--muted)}
.faq-chips{display:flex;gap:8px;flex-wrap:wrap}
.faq-chips button{background:transparent;border:1px solid rgba(255,255,255,0.05);padding:6px 10px;border-radius:999px;color:var(--muted);cursor:pointer}
.picker{display:flex;gap:8px;align-items:center;margin-top:12px;flex-wrap:wrap}
.picker select,.picker input{padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.08);background:transparent;color:inherit}
.toast-wrap{position:fixed;top:14px;left:50%;transform:translateX(-50%);z-index:9999;display:flex;flex-direction:column;gap:8px}
.toast{background:rgba(255,255,255,0.1);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,0.15);color:var(--text);padding:10px 12px;border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.25)}
.itinerary{display:flex;flex-direction:column;height:78vh;padding:10px;gap:12px}
.controls{display:flex;justify-content:space-between;align-items:center}
.itins{flex:1;overflow:auto;display:flex;flex-direction:column;gap:12px;padding-top:6px}
.dayCard{background:rgba(255,255,255,0.03);padding:12px;border-radius:10px;border-left:4px solid var(--accent)}
.small{font-size:13px;color:var(--muted)}
.save-btn{background:transparent;border:1px solid rgba(255,255,255,0.05);color:var(--muted);padding:6px 8px;border-radius:8px;cursor:pointer}
</style>
</head>
<body>
<div class="app">
  <div class="panel chat">
    <div class="top">
      <div class="logo">TB</div>
      <div>
        <div class="title">TravelBuddy</div>
        <div class="subtitle small">Try: "Plan 2 days in Paris"</div>
      </div>
      <button id="themeBtn" class="save-btn" title="Toggle light/dark">ðŸŒ™</button>
    </div>
    <div id="messages" class="messages"></div>
    <div class="inputRow">
      <input id="userInput" placeholder="Type a command..." />
      <button id="sendBtn" class="btn">Send</button>
    </div>
    <div class="quick">
      <button data-msg="Plan 1 day in Paris">1-day Paris</button>
      <button data-msg="Plan 2 days in Tokyo">2-day Tokyo</button>
      <button data-msg="Show popular countries">Popular countries</button>
    </div>
    <div class="faq" aria-label="Traveler FAQs">
      <div class="faq-title">Traveler FAQs</div>
      <div class="faq-chips">
        <button data-faq="how to find cheap flights">Cheap flights</button>
        <button data-faq="do i need travel insurance">Travel insurance</button>
        <button data-faq="how to avoid jet lag">Avoid jet lag</button>
        <button data-faq="best time to visit paris">Best time to visit Paris</button>
        <button data-faq="what to pack for beach">Beach packing list</button>
      </div>
    </div>
    <div class="picker" aria-label="Select a destination and plan">
      <select id="destSelect" aria-label="Destination"></select>
      <input id="daysInput" type="number" min="1" max="3" value="2" aria-label="Days" />
      <button id="planSelectBtn" class="btn" type="button">Plan</button>
      <button id="showSelectBtn" class="save-btn" type="button">Show places</button>
    </div>
    <div class="small">Local demo â€” data stored in your browser</div>
  </div>

  <div class="panel itinerary">
    <div class="controls">
      <div>
        <h3 style="margin:0">Draft Itinerary</h3>
        <div class="small">Generated by TravelBuddy</div>
      </div>
      <div>
        <button id="saveItin" class="btn">Save</button>
        <button id="exportICal" class="btn">Export ICS</button>
      </div>
    </div>
    <div id="itins" class="itins"><div class="small">No itinerary yet</div></div>
  </div>
</div>

<script>
const DESTS = {
  paris: {
    desc: "Paris â€” art, history, romance.",
    places: ["Eiffel Tower", "Louvre Museum", "Notre-Dame", "Montmartre", "Seine Cruise"]
  },
  tokyo: {
    desc: "Tokyo â€” neon lights & ancient temples.",
    places: ["Shibuya Crossing", "Senso-ji Temple", "Tokyo Tower", "Akihabara", "Ueno Park"]
  },
  bali: {
    desc: "Bali â€” beaches, rice terraces & temples.",
    places: ["Ubud", "Uluwatu Temple", "Kuta Beach", "Tegallalang", "Nusa Penida"]
  },
  london: {
    desc: "London â€” royal heritage & modern culture.",
    places: ["Buckingham Palace", "British Museum", "Tower Bridge", "London Eye", "Hyde Park"]
  },
  newyork: {
    desc: "New York â€” the city that never sleeps.",
    places: ["Times Square", "Central Park", "Statue of Liberty", "Empire State Building", "Brooklyn Bridge"]
  },
  rome: {
    desc: "Rome â€” ancient ruins and divine cuisine.",
    places: ["Colosseum", "Vatican City", "Trevi Fountain", "Pantheon", "Roman Forum"]
  },
  dubai: {
    desc: "Dubai â€” luxury, innovation & desert charm.",
    places: ["Burj Khalifa", "Palm Jumeirah", "Dubai Mall", "Desert Safari", "Dubai Fountain"]
  },
  singapore: {
    desc: "Singapore â€” futuristic city with nature blends.",
    places: ["Marina Bay Sands", "Gardens by the Bay", "Sentosa Island", "Chinatown", "Merlion Park"]
  },
  sydney: {
    desc: "Sydney â€” stunning harbor & sunny beaches.",
    places: ["Sydney Opera House", "Harbour Bridge", "Bondi Beach", "Darling Harbour", "The Rocks"]
  },
  barcelona: {
    desc: "Barcelona â€” art, architecture & Mediterranean vibes.",
    places: ["Sagrada Familia", "Park GÃ¼ell", "La Rambla", "Casa BatllÃ³", "Gothic Quarter"]
  },
  venice: {
    desc: "Venice â€” canals, romance & gondolas.",
    places: ["Grand Canal", "St. Markâ€™s Basilica", "Rialto Bridge", "Dogeâ€™s Palace", "Murano Island"]
  },
  hongkong: {
    desc: "Hong Kong â€” skyline views & street food.",
    places: ["Victoria Peak", "Disneyland", "Tsim Sha Tsui", "Temple Street Market", "Lantau Island"]
  },
  bangkok: {
    desc: "Bangkok â€” temples, nightlife & street eats.",
    places: ["Grand Palace", "Wat Arun", "Chatuchak Market", "Khao San Road", "Floating Market"]
  },
  kualaLumpur: {
    desc: "Kuala Lumpur â€” cultural mix & modern skyline.",
    places: ["Petronas Towers", "Batu Caves", "Bukit Bintang", "KL Tower", "Central Market"]
  },
  istanbul: {
    desc: "Istanbul â€” where East meets West.",
    places: ["Hagia Sophia", "Blue Mosque", "Topkapi Palace", "Grand Bazaar", "Bosphorus Cruise"]
  },
  cairo: {
    desc: "Cairo â€” ancient pyramids & Nile beauty.",
    places: ["Giza Pyramids", "Sphinx", "Egyptian Museum", "Khan el-Khalili", "Nile Cruise"]
  },
  athens: {
    desc: "Athens â€” birthplace of democracy.",
    places: ["Acropolis", "Parthenon", "Plaka", "Temple of Zeus", "Syntagma Square"]
  },
  seoul: {
    desc: "Seoul â€” K-culture, fashion & temples.",
    places: ["Gyeongbokgung Palace", "Myeongdong", "Bukchon Hanok Village", "N Seoul Tower", "Hongdae"]
  },
  amsterdam: {
    desc: "Amsterdam â€” canals, bikes & museums.",
    places: ["Rijksmuseum", "Anne Frank House", "Van Gogh Museum", "Dam Square", "Vondelpark"]
  },
  prague: {
    desc: "Prague â€” fairytale charm & medieval streets.",
    places: ["Charles Bridge", "Prague Castle", "Old Town Square", "Astronomical Clock", "Petrin Hill"]
  },
  zurich: {
    desc: "Zurich â€” Swiss luxury & mountain views.",
    places: ["Lake Zurich", "Bahnhofstrasse", "Old Town", "Uetliberg", "Swiss National Museum"]
  },
  berlin: {
    desc: "Berlin â€” history, art & nightlife.",
    places: ["Brandenburg Gate", "Berlin Wall", "Museum Island", "Checkpoint Charlie", "Alexanderplatz"]
  },
  vienna: {
    desc: "Vienna â€” classical music & imperial palaces.",
    places: ["Schonbrunn Palace", "St. Stephenâ€™s Cathedral", "Belvedere", "Opera House", "Prater Park"]
  },
  madrid: {
    desc: "Madrid â€” Spanish art, parks & tapas.",
    places: ["Royal Palace", "Prado Museum", "Retiro Park", "Gran Via", "Plaza Mayor"]
  },
  lisbon: {
    desc: "Lisbon â€” pastel hills & ocean breezes.",
    places: ["Belem Tower", "JerÃ³nimos Monastery", "Alfama", "Tram 28", "LX Factory"]
  },
  moscow: {
    desc: "Moscow â€” history, power & grandeur.",
    places: ["Red Square", "Kremlin", "St. Basilâ€™s Cathedral", "Bolshoi Theatre", "Gorky Park"]
  },
  losangeles: {
    desc: "Los Angeles â€” beaches, film & fame.",
    places: ["Hollywood Sign", "Santa Monica Pier", "Venice Beach", "Universal Studios", "Getty Center"]
  },
  sanfrancisco: {
    desc: "San Francisco â€” hills, bridges & culture.",
    places: ["Golden Gate Bridge", "Alcatraz", "Pier 39", "Chinatown", "Lombard Street"]
  },
  toronto: {
    desc: "Toronto â€” multicultural city of Canada.",
    places: ["CN Tower", "Royal Ontario Museum", "Niagara Falls (day trip)", "Distillery District", "Toronto Islands"]
  },
  vancouver: {
    desc: "Vancouver â€” mountains meet the sea.",
    places: ["Stanley Park", "Capilano Bridge", "Granville Island", "Grouse Mountain", "Gastown"]
  },
  dubrovnik: {
    desc: "Dubrovnik â€” the Pearl of the Adriatic.",
    places: ["Old Town Walls", "Lovrijenac Fortress", "Stradun", "Lokrum Island", "Banje Beach"]
  },
  marrakech: {
    desc: "Marrakech â€” colors, markets & palaces.",
    places: ["Jemaa el-Fnaa", "Majorelle Garden", "Bahia Palace", "Koutoubia Mosque", "Medina"]
  },
  reykjavik: {
    desc: "Reykjavik â€” gateway to Icelandic nature.",
    places: ["Blue Lagoon", "Golden Circle", "Hallgrimskirkja", "Whale Watching", "Harpa Center"]
  },
  edinburgh: {
    desc: "Edinburgh â€” castles & cobblestone charm.",
    places: ["Edinburgh Castle", "Royal Mile", "Arthurâ€™s Seat", "Holyrood Palace", "Calton Hill"]
  },
  oslo: {
    desc: "Oslo â€” fjords & modern design.",
    places: ["Vigeland Park", "Oslo Opera House", "Akershus Fortress", "Fjord Cruise", "Karl Johans Gate"]
  },
  stockholm: {
    desc: "Stockholm â€” islands, innovation & history.",
    places: ["Gamla Stan", "Vasa Museum", "Royal Palace", "Skansen", "ABBA Museum"]
  },
  beijing: {
    desc: "Beijing â€” imperial palaces & the Great Wall.",
    places: ["Great Wall", "Forbidden City", "Tiananmen Square", "Summer Palace", "Temple of Heaven"]
  },
  shanghai: {
    desc: "Shanghai â€” skyline, shopping & culture.",
    places: ["The Bund", "Yu Garden", "Oriental Pearl Tower", "Nanjing Road", "Zhujiajiao Water Town"]
  },
  delhi: {
    desc: "Delhi â€” monuments & street markets.",
    places: ["Red Fort", "India Gate", "Qutub Minar", "Lotus Temple", "Humayunâ€™s Tomb"]
  },
  jaipur: {
    desc: "Jaipur â€” pink city of forts & bazaars.",
    places: ["Amber Fort", "Hawa Mahal", "City Palace", "Jantar Mantar", "Nahargarh Fort"]
  },
  mumbai: {
    desc: "Mumbai â€” city of dreams & sea views.",
    places: ["Gateway of India", "Marine Drive", "Elephanta Caves", "Juhu Beach", "Colaba Causeway"]
  },
  kathmandu: {
    desc: "Kathmandu â€” temples, trekking & heritage.",
    places: ["Swayambhunath", "Pashupatinath", "Durbar Square", "Thamel", "Boudhanath Stupa"]
  },
  bangalore: {
    desc: "Bangalore â€” gardens & technology.",
    places: ["Lalbagh", "Cubbon Park", "Vidhana Soudha", "ISKCON Temple", "MG Road"]
  },
  cancun: {
    desc: "Cancun â€” turquoise waters & Mayan ruins.",
    places: ["Chichen Itza", "Isla Mujeres", "Tulum", "Xcaret Park", "Playa Delfines"]
  },
  miami: {
    desc: "Miami â€” beaches & nightlife.",
    places: ["South Beach", "Ocean Drive", "Little Havana", "Vizcaya Museum", "Wynwood Walls"]
  },
  capeTown: {
    desc: "Cape Town â€” mountains, beaches & vineyards.",
    places: ["Table Mountain", "Robben Island", "Cape Point", "Boulders Beach", "V&A Waterfront"]
  },
  buenosAires: {
    desc: "Buenos Aires â€” tango, steak & passion.",
    places: ["La Boca", "Recoleta", "Teatro Colon", "San Telmo", "Palermo"]
  },
  santiago: {
    desc: "Santiago â€” mountains & culture.",
    places: ["Cerro San Cristobal", "Plaza de Armas", "La Chascona", "Bellavista", "Sky Costanera"]
  },
  auckland: {
    desc: "Auckland â€” harbors & adventures.",
    places: ["Sky Tower", "Waiheke Island", "Mount Eden", "Auckland Museum", "Rangitoto Island"]
  },
  honolulu: {
    desc: "Honolulu â€” surf, sun & aloha spirit.",
    places: ["Waikiki Beach", "Diamond Head", "Pearl Harbor", "Hanauma Bay", "Iolani Palace"]
  },
  doha: {
    desc: "Doha â€” desert luxury & modern design.",
    places: ["Museum of Islamic Art", "Souq Waqif", "The Pearl", "Katara Village", "Corniche"]
  },
  dubrovnik: {
    desc: "Dubrovnik â€” medieval walls & blue seas.",
    places: ["Old Town", "City Walls", "Stradun", "Lovrijenac", "Lokrum Island"]
  },
  lisbon: {
    desc: "Lisbon â€” hills, trams & coastal views.",
    places: ["Belem Tower", "Alfama", "LX Factory", "JerÃ³nimos Monastery", "Tram 28"]
  }
};

// Simple FAQ bank
const FAQ = {
  "how to find cheap flights": "Use flexible dates, set price alerts (Google Flights/Skyscanner), and book 2â€“3 months ahead for international trips.",
  "do i need travel insurance": "Travel insurance is recommended â€” it can cover cancellations, medical emergencies, and lost baggage.",
  "how to avoid jet lag": "Shift your sleep schedule before departure, hydrate, get sunlight on arrival, and use short naps if needed.",
  "best time to visit paris": "Spring (Aprâ€“Jun) and fall (Sepâ€“Oct) have pleasant weather and fewer crowds than summer.",
  "what to pack for beach": "Light clothes, swimwear, sunblock, hat, sunglasses, flip-flops, and a lightweight cover-up."
};

const messages=document.getElementById('messages');
const toastWrap=document.createElement('div');toastWrap.className='toast-wrap';document.body.appendChild(toastWrap);
function showAlert(msg){const t=document.createElement('div');t.className='toast';t.textContent=String(msg);toastWrap.appendChild(t);setTimeout(()=>{t.remove();},3000);}
function formatTitle(s){return String(s).replace(/[_-]+/g,' ').replace(/([a-z])([A-Z])/g,'$1 $2').replace(/^\w/,c=>c.toUpperCase());}
function setTextWithBreaks(el,text){const parts=String(text).split('\n');parts.forEach((p,i)=>{el.appendChild(document.createTextNode(p));if(i<parts.length-1){el.appendChild(document.createElement('br'));}});}
function postMessage(t,from='bot'){
  const e=document.createElement('div');
  e.className='bubble '+(from==='user'?'user':'bot');
  const span=document.createElement('span');
  setTextWithBreaks(span,t);
  e.appendChild(span);
  const meta=document.createElement('div');
  meta.className='meta';
  meta.textContent=new Date().toLocaleTimeString();
  e.appendChild(meta);
  messages.appendChild(e);
  messages.scrollTop=messages.scrollHeight;
}
function findKey(loc){
  const s=String(loc).toLowerCase().replace(/[\s\-]+/g,'');
  return Object.keys(DESTS).find(k=>k.toLowerCase().replace(/\s+/g,'')===s || k.toLowerCase().includes(s));
}
function genPlan(k,d){const data=DESTS[k];const arr=[];const per=Math.ceil(data.places.length/d);for(let i=0;i<d;i++){arr.push(data.places.slice(i*per,(i+1)*per));}return{city:k,days:arr,desc:data.desc};}
function renderItin(plan){
  const wrap=document.getElementById('itins');
  wrap.innerHTML='';
  const frag=document.createDocumentFragment();
  plan.days.forEach((stops,i)=>{
    const d=document.createElement('div');
    d.className='dayCard';
    const s=document.createElement('strong');
    s.textContent=`Day ${i+1}`;
    d.appendChild(s);
    if(!stops||stops.length===0){
      const em=document.createElement('div');
      em.className='small';
      em.textContent='No activities scheduled.';
      d.appendChild(em);
    }else{
      const list=document.createElement('div');
      list.className='small';
      list.textContent=stops.join(', ');
      d.appendChild(list);
    }
    frag.appendChild(d);
  });
  wrap.appendChild(frag);
  window.currentItin=plan;
}
function parseInput(txt){
  const val=String(txt||'').trim();
  if(!val) return;
  postMessage(val,'user');
  const lower=val.toLowerCase();
  if(/^(help|hi|hello|hey)\b/.test(lower)){
    postMessage("Hi! Try: Plan 2 days in Paris â€¢ Show popular countries â€¢ Cheap flights");
    return;
  }
  // FAQ lookup
  for(const q in FAQ){ if(lower.includes(q)){ postMessage(FAQ[q]); return; } }
  const m=val.toLowerCase().match(/plan\s+(\d+)\s*days?\s*(?:in|to)?\s*([a-z0-9_\-\s]+)/);
  if(m){
    const d=parseInt(m[1],10);
    if(d>3){postMessage("Max 3 days supported (try 1â€“3).");return;}
    const key=findKey(m[2]);
    if(!key){
      showAlert('Sorry, I do not have data for that location yet. Try Paris, Tokyo, Bali or London.');
      postMessage("Unknown city. Try Paris, Tokyo, Bali or London.");
      return;
    }
    const plan=genPlan(key,d);
    renderItin(plan);
    postMessage(`Hereâ€™s a ${d}-day plan for ${key.toUpperCase()}!`);
    return;
  }
  if(lower.includes('popular')){postMessage("Popular: Paris, Tokyo, Bali, London");return;}
  showAlert('Sorry, I could not understand that. Try the suggested commands.');
  postMessage("Try commands like 'Plan 2 days in Paris'");
}
document.getElementById('sendBtn').onclick=()=>{const v=document.getElementById('userInput').value;parseInput(v);document.getElementById('userInput').value='';};
document.getElementById('userInput').addEventListener('keydown',(e)=>{if(e.key==='Enter'){e.preventDefault();document.getElementById('sendBtn').click();}});
document.querySelectorAll('.quick button').forEach(b=>b.onclick=()=>parseInput(b.dataset.msg));
document.querySelectorAll('.faq-chips button').forEach(b=>b.onclick=()=>parseInput(b.getAttribute('data-faq')));
// theme persistence
const themeBtn=document.getElementById('themeBtn');
const savedTheme=localStorage.getItem('tb_theme');
if(savedTheme==='light'){document.body.classList.add('light');themeBtn.textContent='â˜€ï¸';}
themeBtn.onclick=()=>{document.body.classList.toggle('light');const light=document.body.classList.contains('light');themeBtn.textContent=light?'â˜€ï¸':'ðŸŒ™';localStorage.setItem('tb_theme',light?'light':'dark');};
document.getElementById('saveItin').onclick=()=>{
  if(window.currentItin){localStorage.setItem('travelbuddy',JSON.stringify(window.currentItin));postMessage("Itinerary saved.");}
  else postMessage("No itinerary to save.");
};
document.getElementById('exportICal').onclick=()=>{
  if(!window.currentItin){postMessage("No itinerary to export.");return;}
  const stamp=new Date().toISOString().replace(/[-:]/g,'').split('.')[0]+'Z';
  let text='BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//TravelBuddy//EN\n';
  window.currentItin.days.forEach((stops,i)=>{
    const summary=`Day ${i+1}`;
    text+=`BEGIN:VEVENT\nUID:day-${i+1}@travelbuddy.local\nDTSTAMP:${stamp}\nSUMMARY:${summary} - ${stops.join(' / ')}\nEND:VEVENT\n`;
  });
  text+='END:VCALENDAR';
  const blob=new Blob([text],{type:'text/calendar'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='itinerary.ics';a.click();postMessage("ICS file exported.");
};

// Populate destination select and wire actions
(function initPicker(){
  const sel=document.getElementById('destSelect');
  if(!sel) return;
  const keys=Object.keys(DESTS);
  const opts=keys.map(k=>({k,label:formatTitle(k)})).sort((a,b)=>a.label.localeCompare(b.label));
  sel.innerHTML='';
  opts.forEach(o=>{const opt=document.createElement('option');opt.value=o.k;opt.textContent=o.label;sel.appendChild(opt);});
  const planBtn=document.getElementById('planSelectBtn');
  const showBtn=document.getElementById('showSelectBtn');
  const daysInput=document.getElementById('daysInput');
  planBtn.onclick=()=>{
    const key=sel.value;const days=Math.max(1,Math.min(3,parseInt(daysInput.value||'2',10)));
    const plan=genPlan(key,days);renderItin(plan);postMessage(`Created a ${days}-day draft for ${formatTitle(key)}.`);
  };
  showBtn.onclick=()=>{
    const key=sel.value;const d=DESTS[key];
    postMessage(`${d.desc}\nTop places: ${d.places.join(', ')}`);
  };
})();
</script>
</body>
</html>
